{% extends "base.html" %}

{% block title %}Prompt Detail - {{ prompt.name }}{% endblock %}

{% block nav_items %}
  <a href="/" class="text-primary-600 hover:text-accent-600 transition-colors">Dashboard</a>
  <a href="/prompts/html/list" class="text-primary-600 hover:text-accent-600 transition-colors">Prompts</a>
  <a href="/profile" class="text-primary-600 hover:text-accent-600 transition-colors">Profile</a>
  <button
    hx-post="/auth/html/logout"
    hx-target="body"
    hx-swap="outerHTML"
    class="text-primary-600 hover:text-accent-600 transition-colors"
  >
    Logout
  </button>
{% endblock %}

{% block content %}
  <div class="flex items-center justify-between mb-6">
    <div>
      <h1 class="text-3xl font-bold text-primary-900">{{ prompt.name }}</h1>
      <p class="mt-1 text-primary-600 text-sm">Last updated {{ prompt.updated_at.strftime('%Y-%m-%d %H:%M:%S') }}</p>
    </div>

    <div class="flex space-x-2">
      <button
        hx-get="/prompts/html/{{ prompt.id }}/edit"
        hx-target="#modal-container"
        hx-swap="innerHTML"
        class="inline-flex items-center px-4 py-2 border border-primary-300 text-sm font-medium rounded-md text-primary-700 bg-white hover:bg-primary-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent-500 transition-colors"
      >
        <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 013.536 3.536L6 21H2v-4L16.732 3.732z" />
        </svg>
        Edit
      </button>

      <button
        hx-delete="/prompts/{{ prompt.id }}"
        hx-confirm="Are you sure you want to delete this prompt?"
        hx-target="body"
        hx-push-url="true"
        class="inline-flex items-center px-4 py-2 border border-red-300 text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors"
      >
        <svg class="-ml-1 mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3m5 0H6" />
        </svg>
        Delete
      </button>
    </div>
  </div>

  <!-- Tags -->
  <div class="mb-4 space-x-2">
    {% for tag in prompt.tags %}
      <span class="inline-flex items-center px-2.5 py-0.5 rounded text-xs font-medium bg-primary-100 text-primary-800">{{ tag.name }}</span>
    {% endfor %}
  </div>

  <!-- Prompt content -->
  <div class="bg-white p-6 rounded-lg border border-primary-200 shadow-sm whitespace-pre-wrap text-primary-900">
    {{ prompt.content }}
  </div>

  <!-- Version history -->
  <h2 class="text-xl font-semibold text-primary-900 mt-10 mb-4">Version History</h2>
  <div id="version-history" hx-get="/prompts/html/{{ prompt.id }}/versions" hx-trigger="load" hx-target="#version-history" hx-swap="innerHTML">
    <!-- Version history will load here -->
  </div>

  <!-- Modal placeholder -->
  <div id="modal-container"></div>
{% endblock %}

{% block scripts %}
  <script>
    // Close modal helper
    document.addEventListener("click", function (event) {
      if (event.target.closest("[data-modal-close]")) {
        document.getElementById("modal-container").innerHTML = "";
      }
    });
  </script>
{% endblock %}
